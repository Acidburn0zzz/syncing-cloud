/*alessandrio*/
if(atom.whenShellEnvironmentLoaded(function(){let a,b,c,d,e,f=atom.views.getView(atom.workspace),g=document.createElement("div"),h=document.createElement("div"),i=!1,j=!1,k="",l=document.createElement("div"),m=document.createElement("header"),n=document.createElement("span"),o=document.createElement("span"),p=document.createElement("div"),q=document.createElement("span"),r=document.createElement("span"),s=document.createElement("div"),t=document.createElement("input"),u=document.createElement("atom-text-editor"),v=document.createElement("div"),w=(b,c,d)=>{g.classList.remove(b),g.classList.add(c),a[d?"hide":"show"](),i=d},x=()=>localStorage.getItem("syncing-dir")||"",y=(a,b)=>{b&&(a=atom.workspace.getActiveTextEditor()),a?(k=a.getTitle(),n.textContent="Syncing - "+k,t.value=a.getPath(),j=!0):(t.value="non file focused",n.textContent="Syncing - non file focused",j=!1),u.getModel().setText(x())},z=(a,b)=>{p.className="syncing-btn syncing-status btn icon icon-sync "+a,p.textContent=b},A=a=>1024>a?a+" Bytes":1048576>a?(a/1024).toFixed(3)+" KB":1073741824>a?(a/1048576).toFixed(3)+" MB":(a/1073741824).toFixed(3)+" GB";l.className="syncing-container",m.className="header syncing-navbar bg-dark",n.className="syncing-title icon icon-upload",n.textContent="Syncing",o.className="syncing-buttons pull-right",r.className="syncing-close icon icon-x",q.className="syncing-settings icon icon-gear",p.className="syncing-btn syncing-status btn icon icon-sync",p.textContent="non syncing",m.appendChild(n),o.appendChild(p),o.appendChild(q),o.appendChild(r),m.appendChild(o),s.className="syncing-box",t.className="syncing-input syncing-path",t.setAttribute("type","text"),t.setAttribute("disabled",!0),u.setAttribute("mini",!0),u.getModel().setPlaceholderText("upload path"),v.className="syncing-btn syncing-sync btn icon icon-sync",v.textContent="Sync",s.appendChild(t),s.appendChild(u),s.appendChild(v),l.appendChild(m),l.appendChild(s),g.innerHTML="&nbsp;",g.className="inline-block syncing-statusbar syncing-statusbar-close",h.classList.add("syncing"),h.appendChild(l),f.getElementsByClassName("status-bar-right")[0].appendChild(g),r.addEventListener("click",function(){w("syncing-statusbar-open","syncing-statusbar-close",!0)}),q.addEventListener("click",function(){atom.workspace.open("atom://config/packages/syncing-cloud")}),v.addEventListener("click",function(){e=u.getModel().getText().trim(),j?e?("/"!=e.substr(-1)&&(e=e.replace(/\/?$/,"/"),u.getModel().setText(e)),localStorage.setItem("syncing-dir",e),v.classList.add("syncing-sync-disabled"),b=new File([JSON.stringify({datable:atom.workspace.getActiveTextEditor().getText(),way:e+k,syncing:"alessandrio"})],"syncing.json",{type:"application/json"}),c=new FormData,d=new XMLHttpRequest,c.append("file",b),z("btn-success","syncing..."),n.textContent="Syncing - "+k+" - "+A(b.size),d.onreadystatechange=function(){4===d.readyState&&200===d.status&&("1"==d.responseText.trim()?z("btn-info","synced!"):z("btn-error","syncing failed! try again"),v.classList.remove("syncing-sync-disabled")),4===d.readyState&&200!==d.status&&(z("btn-error","connection error"),v.classList.remove("syncing-sync-disabled"))},d.open("POST",atom.config.get("syncing-cloud.syncing")),d.withCredentials=!0,d.setRequestHeader("X-Requested-With","XMLHttpRequest"),d.send(c)):(u.focus(),l.classList.add("syncing-novalid")):z("btn-error","non file focus")}),atom.tooltips.add(g,{title:"<span class=\"icon icon-sync\"></span> toggle Syncing box",html:!0,class:"syncing-tooltip",delay:{show:1,hide:100}}),g.addEventListener("click",function(){a.isVisible()?w("syncing-statusbar-open","syncing-statusbar-close",!0):(w("syncing-statusbar-close","syncing-statusbar-open"),y(!1,!0))}),a=atom.workspace.addBottomPanel({item:h,visible:!1}),atom.workspace.onDidChangeActiveTextEditor(function(b){b?(i&&w("syncing-statusbar-close","syncing-statusbar-open"),z("","non syncing"),y(b)):a.isVisible()&&w("syncing-statusbar-open","syncing-statusbar-close",!0)})}),!atom.config.get("syncing-cloud.syncing")||-1<atom.config.get("syncing-cloud.syncing").indexOf("[url]")){let a,b,c,d,e=document.createElement("div");e.classList.add("syncing-starting"),e.innerHTML="<header><strong>Syncing initial settings</strong> - <span>one more step before starting <span class=\"icon icon-heart\"></span></span></header><div class=\"syncing-startingbox\"><p>It is necessary to add a file on your server and puth the URL here. <a href=\"https://github.com/alessandrio/syncing-cloud\" class=\"syncing-github\">Read how to do it</a></p><atom-text-editor class=\"syncing-left\" mini></atom-text-editor><div class=\"syncing-btn syncing-goit btn btn-primary icon icon-zap\">Go it</div><br><p><i>The extension is opened by means of the cloud button <span class=\"inline-block syncing-icon-cloud\">&nbsp;</span> in the status bar (down there).</i></p></div>",d=atom.workspace.addModalPanel({item:e,visible:!1,priority:500}),a=d.element.getElementsByTagName("atom-text-editor")[0],a.getModel().setPlaceholderText("dir"),d.element.getElementsByClassName("syncing-goit")[0].addEventListener("click",function(){c=a.getModel().getText().trim(),c?(atom.config.set("syncing-cloud.syncing",c.replace(/\/?$/,"/")),d.hide(),d.destroy()):a.focus()}),b=setInterval(function(){d.isVisible()||(d.show(),clearInterval(b))},1e3)}
